<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
  
  <link rel="manifest" href="manifest.json">

  <meta name="theme-color" content="#22c55e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Calorie Tracker">

  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="icon" href="icon-192.png">


  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calorie Tracker</title>
</head>

    <title>‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà + ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f3f4f6;
            padding: 20px;
        }
        .container {
            max-width: 520px;
            margin: auto;
            background: #ffffff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        h2, h3 {
            text-align: center;
        }
        label {
            font-weight: bold;
            margin-top: 10px;
            display: block;
        }
        input, select, button {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-size: 16px;
        }
        button {
            background-color: #22c55e;
            color: white;
            border: none;
            margin-top: 10px;
            cursor: pointer;
        }
        button:hover {
            background-color: #16a34a;
        }
        .danger {
            background-color: #ef4444;
        }
        .danger:hover {
            background-color: #dc2626;
        }
        .result, .summary {
            margin-top: 15px;
            padding: 15px;
            background: #ecfdf5;
            border-radius: 8px;
            font-size: 16px;
        }
        .food-list {
            margin-top: 10px;
        }
        .food-item {
            background: #f9fafb;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .food-item button {
            background: #ef4444;
            padding: 6px 10px;
            font-size: 14px;
            border-radius: 6px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>

<div class="container">

    <!-- üîê ‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ -->
    <div id="authSection">
        <h2>üîê ‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</h2>

        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label>
        <input type="text" id="username" placeholder="‡πÄ‡∏ä‡πà‡∏ô natapong">

        <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
        <input type="password" id="password" placeholder="********">

        <button onclick="register()">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
        <button onclick="login()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>

        <div id="authMessage" style="margin-top:10px; color:red;"></div>
    </div>

    <!-- ü•ó ‡πÅ‡∏≠‡∏õ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà -->
    <div id="appSection" class="hidden">
        <h2>ü•ó ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</h2>
        <p style="text-align:center;">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: <strong id="currentUser"></strong></p>
        <button class="danger" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>

        <label>‡πÄ‡∏û‡∏®</label>
        <select id="gender">
            <option value="male">‡∏ä‡∏≤‡∏¢</option>
            <option value="female">‡∏´‡∏ç‡∏¥‡∏á</option>
        </select>

        <label>‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ)</label>
        <input type="number" id="age" placeholder="‡πÄ‡∏ä‡πà‡∏ô 20">

        <label>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡∏ã‡∏°.)</label>
        <input type="number" id="height" placeholder="‡πÄ‡∏ä‡πà‡∏ô 170">

        <label>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å‡∏Å.)</label>
        <input type="number" id="weight" placeholder="‡πÄ‡∏ä‡πà‡∏ô 65">

        <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label>
        <select id="activity">
            <option value="1.2">‡∏ô‡∏±‡πà‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡πÑ‡∏°‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢</option>
            <option value="1.375">‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡πÄ‡∏ö‡∏≤ ‡πÜ (1‚Äì3 ‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå)</option>
            <option value="1.55">‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á (3‚Äì5 ‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå)</option>
            <option value="1.725">‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏ô‡∏±‡∏Å (6‚Äì7 ‡∏ß‡∏±‡∏ô/‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå)</option>
            <option value="1.9">‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏ô‡∏±‡∏Å‡∏°‡∏≤‡∏Å (‡∏á‡∏≤‡∏ô‡πÉ‡∏ä‡πâ‡πÅ‡∏£‡∏á + ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢)</option>
        </select>

        <button onclick="calculateCalories()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà</button>

        <div class="result" id="result">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</div>

        <hr>

        <h3>üçΩÔ∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏°‡∏∑‡πâ‡∏≠</h3>

        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
        <input type="text" id="foodName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤‡πÑ‡∏Å‡πà">

        <label>‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà (kcal)</label>
        <input type="number" id="foodCalories" placeholder="‡πÄ‡∏ä‡πà‡∏ô 550">

        <label>‡∏°‡∏∑‡πâ‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
        <select id="mealType">
            <option value="‡πÄ‡∏ä‡πâ‡∏≤">‡πÄ‡∏ä‡πâ‡∏≤</option>
            <option value="‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô">‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô</option>
            <option value="‡πÄ‡∏¢‡πá‡∏ô">‡πÄ‡∏¢‡πá‡∏ô</option>
            <option value="‡∏Ç‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á">‡∏Ç‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á</option>
        </select>

        <button onclick="addFood()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£</button>

        <div class="food-list" id="foodList"></div>

        <div class="summary" id="summary">
            üî¢ ‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: 0 kcal
        </div>

        <button class="danger" onclick="clearAll()">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    </div>

</div>

<script>
let currentUser = null;
let foods = [];
let tdeeValue = 0;

// ================= ‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ =================

function register() {
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value;

    if (!username || !password) {
        showAuthMessage("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô");
        return;
    }

    const users = JSON.parse(localStorage.getItem("users") || "{}");

    if (users[username]) {
        showAuthMessage("‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß");
        return;
    }

    users[username] = password; // (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™)
    localStorage.setItem("users", JSON.stringify(users));
    showAuthMessage("‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö", "green");
}

function login() {
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value;

    const users = JSON.parse(localStorage.getItem("users") || "{}");

    if (!users[username] || users[username] !== password) {
        showAuthMessage("‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
        return;
    }

    currentUser = username;
    localStorage.setItem("currentUser", currentUser);
    loadUserData();
    showApp();
}

function logout() {
    currentUser = null;
    localStorage.removeItem("currentUser");
    showAuth();
}

function showAuthMessage(msg, color = "red") {
    const el = document.getElementById("authMessage");
    el.innerText = msg;
    el.style.color = color;
}

function showApp() {
    document.getElementById("authSection").classList.add("hidden");
    document.getElementById("appSection").classList.remove("hidden");
    document.getElementById("currentUser").innerText = currentUser;
}

function showAuth() {
    document.getElementById("authSection").classList.remove("hidden");
    document.getElementById("appSection").classList.add("hidden");
}

// ================= ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ =================

window.onload = function() {
    const savedUser = localStorage.getItem("currentUser");
    if (savedUser) {
        currentUser = savedUser;
        loadUserData();
        showApp();
    }
};

function loadUserData() {
    const data = JSON.parse(localStorage.getItem(`data_${currentUser}`) || "{}");
    foods = data.foods || [];
    tdeeValue = data.tdee || 0;
    renderFoodList();
    updateSummary();
}

// ================= ‡πÅ‡∏≠‡∏õ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà =================

function saveUserData() {
    const data = {
        foods: foods,
        tdee: tdeeValue
    };
    localStorage.setItem(`data_${currentUser}`, JSON.stringify(data));
}

function calculateCalories() {
    const gender = document.getElementById("gender").value;
    const age = parseFloat(document.getElementById("age").value);
    const height = parseFloat(document.getElementById("height").value);
    const weight = parseFloat(document.getElementById("weight").value);
    const activity = parseFloat(document.getElementById("activity").value);
    const resultDiv = document.getElementById("result");

    if (!age || !height || !weight) {
        resultDiv.innerText = "‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô";
        return;
    }

    let bmr;
    if (gender === "male") {
        bmr = 10 * weight + 6.25 * height - 5 * age + 5;
    } else {
        bmr = 10 * weight + 6.25 * height - 5 * age - 161;
    }

    const tdee = bmr * activity;
    tdeeValue = tdee;

    resultDiv.innerHTML = `
        üî• BMR: ${bmr.toFixed(0)} kcal/‡∏ß‡∏±‡∏ô<br>
        ‚ö° TDEE: ${tdee.toFixed(0)} kcal/‡∏ß‡∏±‡∏ô
    `;

    saveUserData();
    updateSummary();
}

function addFood() {
    const name = document.getElementById("foodName").value.trim();
    const calories = parseFloat(document.getElementById("foodCalories").value);
    const meal = document.getElementById("mealType").value;

    if (!name || !calories) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà");
        return;
    }

    foods.push({ name, calories, meal });
    document.getElementById("foodName").value = "";
    document.getElementById("foodCalories").value = "";

    renderFoodList();
    updateSummary();
    saveUserData();
}

function removeFood(index) {
    foods.splice(index, 1);
    renderFoodList();
    updateSummary();
    saveUserData();
}

function renderFoodList() {
    const foodListDiv = document.getElementById("foodList");
    foodListDiv.innerHTML = "";

    foods.forEach((food, index) => {
        const div = document.createElement("div");
        div.className = "food-item";
        div.innerHTML = `
            <span>üçΩÔ∏è ${food.meal}: ${food.name} - ${food.calories} kcal</span>
            <button onclick="removeFood(${index})">‡∏•‡∏ö</button>
        `;
        foodListDiv.appendChild(div);
    });
}

function updateSummary() {
    const totalCalories = foods.reduce((sum, food) => sum + food.calories, 0);
    const summaryDiv = document.getElementById("summary");

    let message = `üî¢ ‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: ${totalCalories} kcal`;

    if (tdeeValue > 0) {
        if (totalCalories > tdeeValue) {
            message += `<br>‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ ${Math.round(totalCalories - tdeeValue)} kcal`;
        } else {
            message += `<br>‚úÖ ‡∏¢‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å ${Math.round(tdeeValue - totalCalories)} kcal`;
        }
    }

    summaryDiv.innerHTML = message;
}

<script>
    function clearAll() {
    if (confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) {
        foods = [];
        tdeeValue = 0;
        saveUserData();
        renderFoodList();
        document.getElementById("summary").innerHTML = "üî¢ ‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: 0 kcal";
        document.getElementById("result").innerText = "‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì";
    }
}
</script>    
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}    
</script>

</body>
</html>




